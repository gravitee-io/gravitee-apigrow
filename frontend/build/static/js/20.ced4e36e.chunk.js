(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{1746:function(e,t,a){"use strict";a.r(t);var n=a(35),r=a.n(n),o=a(59),i=a(109),l=a(16),c=a(17),s=a(19),d=a(18),u=a(20),m=a(0),h=a.n(m),p=a(56),b=a(70),g=a(1570),f=a(1008),E=a.n(f),v=a(265),C=a(9),y=a(900),w=a(807),k=a(1038),P=a(758),x=a(47),S=a(605),O=a(607),I=a(597),T=a(598),N=a(606),j=a(636),D=a(264),L=a(599),M=a(889),A=a(634),z=a(628),F=a(629),R=a(556),q=a(952),U=a(951),B=a.n(U),G=a(837),H=a.n(G),W=a(1093),J=a(8),K=a(248),Y=a(627),Q=a(633),X=Object(K.a)({overrides:{MuiIconButton:{root:{fontSize:"1rem"},label:{display:"block"}}}}),V=Object(Y.a)({root:{"&:hover":{backgroundColor:"transparent"}},icon:function(e){return{fontSize:"15px",fontWeight:"bold",borderRadius:30,display:"table-cell",border:"3px solid ".concat(e.customcolor),color:e.customcolor,width:90,height:30,"input:hover ~ &":{backgroundColor:"#ebf1f5"},"input:disabled ~ &":{background:"rgba(206,217,224,.5)"},boxShadow:"0 3px 5px 2px rgba(255, 105, 135, .3)"}},checkedIcon:function(e){return{borderRadius:30,display:"table-cell",border:"3px solid ".concat(e.customcolor),color:"white",backgroundColor:"".concat(e.customcolor),width:90,height:30,"input:hover ~ &":{backgroundColor:"#ebf1f5"},boxShadow:"0 3px 5px 2px rgba(255, 105, 135, .3)"}}});function Z(e){var t=V(e);return h.a.createElement(h.a.Fragment,null,h.a.createElement(Q.a,{theme:X},h.a.createElement(M.a,Object.assign({className:t.root,checkedIcon:h.a.createElement("span",{className:Object(J.a)(t.icon,t.checkedIcon)},e.label),icon:h.a.createElement("span",{className:t.icon},e.label)},e))))}function $(e){return h.a.createElement("div",{style:{margin:"auto"}},h.a.createElement(Z,e))}var _=a(686),ee=function(){return{margin:{margin:"auto"},editContainer:{overflowY:"auto",overflowX:"hidden",padding:"10px !important",backgroundColor:"white",width:"20%",minWidth:"20%",zIndex:10},fieldContainer:{padding:"10px",display:"grid"},formControl:{margin:"10px"},formLabel:{margin:"auto",fontSize:"1.4em",padding:"10px"},ExpansionPanelDetails:{display:"grid"},hideEditIcon:{color:"#324157",width:"fit-content",marginBottom:"10px"},hideIconContainer:{width:"100%",display:"flex",justifyContent:"flex-end"},referencePaper:{padding:"20px",display:"inline-grid",margin:"10px"}}},te=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(s.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).state={models:[]},a.onChange=function(e){var t,n=e.target;t="abstract"===n.name||"queryable"===n.name||"paginable"===n.name||"calculated"===n.name||"patchable"===n.name||"notImplemented"===n.name||"isArray"===n.name?Object(x.a)({},n.name,n.checked):"SEARCH"===n.name||"POST"===n.name||"GET"===n.name||"PUT"===n.name||"DELETE"===n.name?{verbs:[n.name]}:Object(x.a)({},n.name,n.value),"type"===n.name&&"reference"===n.value&&(t.referenceId=a.state.models[0].id,t.children=[]),a.props.onToolsMenuChange(t)},a.onBranchColorChange=function(e){var t={branchColor:e.hex};a.props.onToolsMenuChange(t)},a.onSubpathCheckboxChange=function(e){var t=e.target,n={isSubPath:t.checked};t.checked&&(n.verbs=["SEARCH","POST","PUT","GET","DELETE"]),a.props.onToolsMenuChange(n)},a.handleChange=function(e){return function(t){a.setState(Object(i.a)({},e,Object(x.a)({},e,t.target.checked)))}},a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;_.a.getModels({organization:this.props.organization,pageSize:0}).then((function(t){e.setState({models:t.data.data.filter((function(t){return t.id!==e.props.modelId}))})}))}},{key:"componentDidUpdate",value:function(e){this.props.isFocus!==e.isFocus&&this.nameInput&&this.nameInput.focus()}},{key:"render",value:function(){var e=this,t=this.props,a=t.node,n=t.classes,r=t.onEditClick;return a.patchable=!!a.patchable,a.notImplemented=!!a.notImplemented,a.xDescription=a.xDescription||"",a.verbs=a.verbs||["SEARCH","POST","PUT","GET","DELETE"],a.branchColor=a.branchColor||"#FCB900",a.verbs=a.verbs.filter((function(e){return"UPDATE"!==e})),h.a.createElement("div",{className:n.editContainer},h.a.createElement("div",{className:n.fieldContainer},h.a.createElement("div",{className:n.hideIconContainer},h.a.createElement(v.a,{id:"editHideButton",onClick:r,className:n.hideEditIcon},h.a.createElement(B.a,null))),h.a.createElement("label",{className:"title-menu"},"Edit attribute"),h.a.createElement(S.a,{title:"Name of the attribute. Special case: if you specify comma-separated words, they'll serve as a list of possible values for the parent",placement:"right"},h.a.createElement(O.a,{disabled:!a.parent,InputLabelProps:{shrink:!0},id:"outlined-email-input",label:"Label",name:"name",margin:"normal",variant:"outlined",onChange:this.onChange,onKeyDown:function(t){13===t.keyCode&&e.props.onEnterDown()},className:"item-sidepanel",value:a.name,inputRef:function(t){e.nameInput=t}})),a.parent&&h.a.createElement(h.a.Fragment,null,h.a.createElement(S.a,{title:"A description to help developer who will use the API",placement:"right"},h.a.createElement(O.a,{multiline:!0,disabled:!a.parent,InputLabelProps:{shrink:!0},id:"outlined-textarea",label:"Description",name:"description",margin:"normal",variant:"outlined",onChange:this.onChange,className:"item-sidepanel",value:a.description})),h.a.createElement(S.a,{title:"The description that isn't public or included in the Swagger but only displayed to help API",placement:"right"},h.a.createElement(O.a,{multiline:!0,disabled:!a.parent,InputLabelProps:{shrink:!0},id:"outlined-email-input",label:"Example",type:"example",name:"example",autoComplete:"example",margin:"normal",variant:"outlined",onChange:this.onChange,className:"item-sidepanel",value:a.example})),h.a.createElement(I.a,{disabled:!a.parent,variant:"outlined",margin:"normal"},h.a.createElement(T.a,{ref:function(t){e.InputLabelRef=t},htmlFor:"type-select"},"Type"),h.a.createElement(N.a,{className:"dropdown",native:!0,value:a.type,onChange:this.onChange,input:h.a.createElement(j.a,{name:"type",labelWidth:35,id:"type-select"})},h.a.createElement("option",{value:"integer"},"integer"),h.a.createElement("option",{value:"number"},"number"),h.a.createElement("option",{value:"string"},"text"),h.a.createElement("option",{value:"boolean"},"boolean"),h.a.createElement("option",{value:"array"},"list"),h.a.createElement("option",{value:"object"},"object"),h.a.createElement("option",{value:"reference"},"reference to..."))),"reference"===a.type&&h.a.createElement(D.a,{className:n.referencePaper},h.a.createElement(L.a,null,"Reference"),h.a.createElement(I.a,{variant:"outlined",margin:"normal"},h.a.createElement(T.a,{ref:function(t){e.InputLabelRef=t},htmlFor:"reference-select"},"Model"),h.a.createElement(N.a,{className:"dropdown",native:!0,value:a.referenceId,onChange:this.onChange,input:h.a.createElement(j.a,{name:"referenceId",labelWidth:45,id:"reference-select"})},this.state.models.map((function(e){return h.a.createElement("option",{key:e.id,value:e.id},"".concat(e.name).concat("0"!==e.freezeTag?" (frozen)":""))})))),h.a.createElement(S.a,{title:"Determine if the reference model should be a simple object or an array",placement:"right"},h.a.createElement("label",null,h.a.createElement(M.a,{color:"default",onChange:this.onChange,type:"checkbox",name:"isArray",checked:a.isArray}),"Is Array")),h.a.createElement(h.a.Fragment,null,h.a.createElement(S.a,{title:"Define branch color (with children)",placement:"right"},h.a.createElement("label",{style:{fontSize:"14px","padding-bottom":"10px"}},"Color Branch")),h.a.createElement(W.TwitterPicker,{color:a.branchColor,triangle:"hide",width:"auto",onChangeComplete:this.onBranchColorChange,style:{"padding-bottom":"20px",margin:"auto"}}))),"reference"!==a.type&&h.a.createElement(S.a,{title:"make this field searchable (include it in query params for searchs with GET /objects?field=...)",placement:"right"},h.a.createElement("label",null,h.a.createElement(M.a,{disabled:!a.parent,color:"default",onChange:this.onChange,type:"checkbox",name:"queryable",checked:a.queryable}),"Searchable")),h.a.createElement(S.a,{title:"make this field appear in search results (reponse to GET /objects)",placement:"right"},h.a.createElement("label",null,h.a.createElement(M.a,{disabled:!a.parent,color:"default",onChange:this.onChange,type:"checkbox",name:"abstract",checked:a.abstract}),"In abstract"))),"reference"!==a.type&&h.a.createElement(A.a,null,h.a.createElement(z.a,{expandIcon:h.a.createElement(H.a,null),"aria-controls":"panel1a-content",id:"panel1a-header"},h.a.createElement(L.a,{className:n.heading},"Advanced settings")),h.a.createElement(F.a,{className:n.ExpansionPanelDetails},h.a.createElement(h.a.Fragment,null,h.a.createElement(S.a,{title:"Define color branch (with children)",placement:"right"},h.a.createElement("label",{style:{fontSize:"14px","padding-bottom":"10px"}},"Color branch")),h.a.createElement(W.TwitterPicker,{color:a.branchColor,triangle:"hide",width:"auto",onChangeComplete:this.onBranchColorChange,style:{"padding-bottom":"20px",margin:"auto"}})),a.parent&&h.a.createElement(h.a.Fragment,null,h.a.createElement(S.a,{title:"Make a sub context for this field (will be accessible by GET /objects/thisfield).",placement:"right"},h.a.createElement("label",null,h.a.createElement(M.a,{disabled:!a.parent,color:"default",onChange:this.onSubpathCheckboxChange,type:"checkbox",name:"isSubPath",checked:a.isSubPath}),"Subpath")),h.a.createElement(S.a,{title:"When this box is checked, the attribute will be individually updatable. Otherwise, updates are only possible for all the fields together.",placement:"right"},h.a.createElement("label",null,h.a.createElement(M.a,{disabled:!a.parent,color:"default",onChange:this.onChange,type:"checkbox",name:"patchable",checked:a.patchable}),"Partial update")),h.a.createElement(S.a,{title:"Fields that are not yet implemented do not appear in the swagger result",placement:"right"},h.a.createElement("label",{style:{fontSize:"14px"}},h.a.createElement(M.a,{disabled:!a.parent,color:"default",onChange:this.onChange,type:"checkbox",name:"notImplemented",checked:a.notImplemented}),"Not yet implemented")),h.a.createElement(S.a,{title:"calculated fields are not included in object creation requests (POST body) because one does not know their value at creation time",placement:"right"},h.a.createElement("label",null,h.a.createElement(M.a,{disabled:!a.parent,color:"default",onChange:this.onChange,type:"checkbox",name:"calculated",checked:a.calculated}),"Calculated"))),"reference"!==a.type&&h.a.createElement(h.a.Fragment,null,h.a.createElement(S.a,{title:"make the results paginated (adds the query parameters page & pageSize)",placement:"right"},h.a.createElement("label",null,h.a.createElement(M.a,{disabled:(!a.isSubPath||"array"!==a.type)&&!!a.parent||!1,color:"default",onChange:this.onChange,type:"checkbox",name:"paginable",checked:a.paginable}),"Pagination")),h.a.createElement(S.a,{title:"Optionally define here additionals query params, comma-separated. Those terms come in addition to the ones that are 'searchable'",placement:"right"},h.a.createElement(O.a,{disabled:(!a.isSubPath||"array"!==a.type)&&!!a.parent||!1,label:"Query Params",type:"queryParams",name:"queryParams",margin:"normal",variant:"outlined",onChange:this.onChange,className:"item-sidepanel",value:a.queryParams||""})),h.a.createElement(S.a,{title:"An optional, internal explanation for those who have to implement this API. For instance the database where to find the data for this attribute. ( Not included in the public Swagger )",placement:"right"},h.a.createElement(O.a,{multiline:!0,disabled:!a.parent,InputLabelProps:{shrink:!0},id:"outlined-textarea",label:"Internal Description",name:"xDescription",margin:"normal",variant:"outlined",onChange:this.onChange,className:"item-sidepanel",value:a.xDescription}))),(a.isSubPath||!a.parent)&&h.a.createElement(I.a,{component:"fieldset",className:n.formControl},h.a.createElement(R.a,{className:n.formLabel,component:"legend"},"Operations"),h.a.createElement(q.a,null,(!a.parent||"array"===a.type)&&h.a.createElement($,{customcolor:"#61affe",label:"SEARCH",name:"SEARCH",type:"checkbox",checked:a.verbs.includes("SEARCH"),onChange:this.onChange}),(!a.parent||"array"===a.type)&&h.a.createElement($,{customcolor:"#49cc90",label:"CREATE",name:"POST",type:"checkbox",checked:a.verbs.includes("POST"),onChange:this.onChange}),h.a.createElement($,{customcolor:"#61affe",label:"READ",name:"GET",type:"checkbox",checked:a.verbs.includes("GET"),onChange:this.onChange}),h.a.createElement($,{customcolor:"#fca130",label:"UPDATE",name:"PUT",type:"checkbox",checked:a.verbs.includes("PUT"),onChange:this.onChange}),(!a.parent||"array"===a.type)&&h.a.createElement($,{customcolor:"#f93e3e",label:"DELETE",name:"DELETE",type:"checkbox",checked:a.verbs.includes("DELETE"),onChange:this.onChange})))))))}}]),t}(m.Component),ae=Object(C.a)(ee)(te),ne=a(1040),re=a(746),oe=a(1007),ie=a(34),le=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,c=new Array(n),u=0;u<n;u++)c[u]=arguments[u];return(a=Object(s.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(c)))).state={history:[],saved:!1,canBeSaved:!1,currentNode:{nodeKey:""},data:{children:[],name:""},refinerRules:[],livePreviewSwagger:null,isLivePreviewOpen:!0,isEditMenuOpen:!0,focus:"tree",modelId:a.props.location.state?a.props.location.state.modelId:null,organizationId:a.props.location.state?a.props.location.state.organizationId:null},a.intervalId=null,a.onNodeSelect=function(e){a.setState({currentNode:Object(i.a)({},e)})},a.onTreeUpdate=function(e){var t=e.dataUpdated,n=e.currentNode,r=a.state,o=r.history,i=r.data;o.push(i),a.setState({data:t,currentNode:n,history:o,saved:!1}),a.requestLivePreview(t)},a.saveModel=function(e){var t=a.state,n=(t.saved,t.modelId),r=t.data,o=a.props.location.state.isPublic;!e&&o||_.a.saveModel(n,{data:r},e).then((function(){a.setState({saved:!0})})).catch((function(e){403===e.response.status?p.Notification.error({title:"Error",message:"You can only modify your own models. Please ask your team leader if you need a modification on this model."}):p.Notification.error({title:"Error",message:"Could not save. Please log in"})}))},a.onToolsMenuChange=function(e){var t=a.state,n=t.currentNode,r=t.data,o=a.state.history;if(e.verbs)if(n.verbs.includes(e.verbs[0])){var l={verbs:n.verbs.filter((function(t){return t!==e.verbs[0]}))};e.hasOwnProperty("isSubPath")&&(l.isSubPath=e.isSubPath),n=Object(i.a)({},n,l)}else{var c={verbs:n.verbs.concat(e.verbs)};e.hasOwnProperty("isSubPath")&&(c.isSubPath=e.isSubPath),n=Object(i.a)({},n,c)}else n=Object(i.a)({},n,e);r=Object(P.f)(r,n),o.push(r),a.setState({data:r,history:o,currentNode:n,saved:!1}),a.requestLivePreview(r)},a.onPreviewClick=function(){var e=a.state,t=e.isLivePreviewOpen,n=e.data;a.setState({isLivePreviewOpen:!t}),t||a.requestLivePreview(n)},a.onEditClick=function(){var e=a.state.isEditMenuOpen;a.setState({isEditMenuOpen:!e})},a.onPreviewClose=function(){a.setState({isLivePreviewOpen:!1})},a.onUndo=function(){var e=a.state.history;if(0!==e.length){var t=e.pop();a.setState({currentNode:t,data:t,history:e})}},a.setFocus=function(e){a.state.focus!==e&&a.setState({focus:e})},a.requestLivePreview=function(){var e=Object(o.a)(r.a.mark((function e(t){var n,o,i,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.state,o=n.isLivePreviewOpen,i=n.refinerRules,l=a.state.organizationId?a.state.organizationId:1,o&&Object(w.trackPromise)(re.a.requestLivePreview({data:t,refinerRules:i},l).then((function(e){a.setState({livePreviewSwagger:e})})));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.location,n=t.history;if(a.state){var r=a.state,o=r.data,l=r.modelId;r.isPublic?this.setState({data:o,currentNode:Object(i.a)({},o)},(function(){e.saveModel(!1),e.requestLivePreview(e.state.data)})):_.a.getModel(l).then((function(t){var a=(Date.now()-new Date(t.updatedAt).getTime())/1e3;!t.hasExited&&Math.abs(a)<11&&n.push({pathname:"/dashboard",state:{error:"Someone already editing this model. Please try again later"}}),e.setState({data:t.data,refinerRules:t.refinerRules||[],currentNode:Object(i.a)({},t.data),canBeSaved:!0},(function(){e.saveModel(!1),e.requestLivePreview(e.state.data)}))})),this.intervalId=setInterval((function(){e.state.canBeSaved&&e.saveModel(!1)}),1e4)}else n.push("/dashboard")}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalId),this.state.canBeSaved&&this.saveModel(!0)}},{key:"render",value:function(){var e=this,t=this.state,a=t.currentNode,n=t.data,r=t.focus,o=t.isLivePreviewOpen,i=t.isEditMenuOpen,l=t.livePreviewSwagger,c=this.props,s=c.classes,d=c.location,u=d.state?d.state.modelId:null,m=h.a.createElement(y.a,{direction:"w",handleClass:s.customHandle,borderClass:s.customResizeBorder,style:{position:"inherit",right:"0",width:"45%",maxWidth:"80%",zIndex:10}},h.a.createElement(ne.a,{swagger:l,onPreviewClick:this.onPreviewClick})),p="";return p=o?i?"small-tree":"left-half-tree":i?"right-half-tree":"full-tree",n?h.a.createElement("div",{className:s.svgContainer},h.a.createElement(g.a,{direction:"right",in:i,mountOnEnter:!0,unmountOnExit:!0},h.a.createElement(ae,{organization:this.state.organizationId,modelId:this.state.modelId,node:a,onToolsMenuChange:this.onToolsMenuChange,onEnterDown:function(){return e.setFocus("tree")},isFocus:"menu"===r,onEditClick:this.onEditClick})),h.a.createElement("div",{className:"relative-container ".concat(p)},(this.context.user.organizations,h.a.createElement(h.a.Fragment,null,h.a.createElement(k.a,Object.assign({},this.props,{animated:!0,data:n,modelId:u,currentNode:a,isFocus:"tree"===r,width:p,onNodeSelect:this.onNodeSelect,onToolsMenuChange:this.onToolsMenuChange,onTreeUpdate:this.onTreeUpdate,newModel:function(){return e.handleNewModelWarningOpen()},onLetterDown:function(){return e.setFocus("menu")},onFocus:function(){return e.setFocus("tree")},onUndo:this.onUndo}))))),h.a.createElement(g.a,{direction:"left",in:o,mountOnEnter:!0,unmountOnExit:!0},m),!o&&h.a.createElement(v.a,{id:"previewShowButton",color:"primary",onClick:function(){return e.onPreviewClick()},className:s.showIcon},h.a.createElement(E.a,null)),!i&&h.a.createElement(v.a,{id:"editShowButton",color:"primary",onClick:function(){return e.onEditClick()},className:s.showIconEdit},h.a.createElement(E.a,null))):null}}]),t}(m.Component);le.contextType=ie.a;t.default=Object(b.g)(Object(C.a)(oe.a)(le))}}]);
//# sourceMappingURL=20.ced4e36e.chunk.js.map